{% extends "base.html" %}

{% block content %}

  <!-- ======= srart Breadcrumbs ======= -->
  <section class="breadcrumbs py-4 justify-content-center" >
    <div class="container">
    
      <h2 class="title ">تفاصيل الجلسة رقم {{ session.number }}</h2>
      <p class="col-lg-10 col-12">
         التاريخ: {{ session.date|date:"d-m-Y" }}
      </p>
      
    </div>
  </section>
  <!-- End Breadcrumbs -->

<div class="container my-5">
    <div class="text-center">
        {% if user.is_superuser %}
        <div class="d-flex justify-content-between">
            <a href="{% url 'generate_qr_code' session.id %}" class="btn">QR CODE</a>
            

            <a class="btn " href="{% url "session_rating_list" session.id %}">التقييمات</a>
            </div>
        {% else %}
        {% if student_attendances %}
        <h6 class="text-center text-success">تم تأكيدحضورك</h6>
            {% if session_rating %}
                <div class="rating-section my-4">
                    <h4>تقيمك</h4>
                    <a href="{% url "update_session_rating" session_rating.id %}" class="btn btn-success btn-sm"><i class="bi bi-pencil-square"></i></a>
                    <div class="rating" style="font-size: 24px;">
                        <input type="hidden" name="rating" id="rating" value="{{ session_rating.rating }}">
                        {% for i in "12345" %}
                            {% if i|add:0 <= session_rating.rating %}
                                <span class="bi bi-star text-warning"></span>  <!-- Filled star -->
                            {% else %}
                                <span class="bi bi-star"></span> <!-- Empty star -->
                            {% endif %}
                        {% endfor %}
                    </div>
                    <p class="mt-2">{{ session_rating.message }}</p>
                </div>
            {% else %}
                <a href="{% url "add_session_rating" session.id %}" class="btn btn-success">قيم الجلسة</a>
            {% endif %}
            {% else %}
            <h6 class="text-center text-danger">عذرا لم يتم تأكيد الحضور</h6>
            <hr>
            {% endif %}
            {% comment %} <h4 class="text-center text-primary">إختبار قبل الجلسة</h4>
            {% if evaluation_tamplate %}
            {% for evaluation in evaluation_tamplate  %}
            {{evaluation.question}}
             <textarea name="test" id="id" class="form-control"></textarea>
            {% endfor %}
            {% else %}
            <h6 class="text-center text-danger">لا يوجد إختبار قبلي بعد</h6>
            {% endif %}
            <hr>
            <h4 class="text-center text-primary">إختبار بعد الجلسة</h4>
            {% if evaluation_tamplate %}
            {{evaluation_tamplate}}
            {% else %}
            <h6 class="text-center text-danger">لا يوجد إختبار بعدي بعد</h6>
            {% endif %} {% endcomment %}
        {% endif %}
    </div>
    
    {% if user.is_superuser %}
    <!-- قائمة الطلاب الذين حضروا الجلسة -->
    <h3 class="text-center unique-text">الحضور</h3>

    <!-- جدول الطلاب -->
    <div class="table-responsive">
        <table class="table table-striped text  text-center">
            <thead class="thead">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">الاسم الكامل</th>
                </tr>
            </thead>
            <tbody>
                {% if attendances %}
                    {% for attendance in attendances %}
                    <tr class="text-light">
                        <th scope="row">{{ forloop.counter }}</th>
                        <td>{{ attendance.student.fullName }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr class="text-light">
                        <td colspan="2" class="text-center">لا يوجد طلاب حضروا هذه الجلسة.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    {% endif %}
</div>
{% endblock %}
